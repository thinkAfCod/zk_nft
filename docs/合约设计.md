# 合约设计

此项目包含这些合约文件: 

1. [NFT.sol](https://github.com/kevinz917/zk-NFT/blob/main/contracts/NFT.sol)

2. [mintProof.sol](https://github.com/kevinz917/zk-NFT/blob/main/contracts/mintProof.sol)

3. [partialRevealProof.sol](https://github.com/kevinz917/zk-NFT/blob/main/contracts/partialRevealProof.sol)

4. [revealProof.sol](https://github.com/kevinz917/zk-NFT/blob/main/contracts/revealProof.sol)

其中mintProof.sol、partialRevealProof.sol、revealProof.sol这三个合约由snarkjs工具导出，分别对应mint proof、revealAttribute Proof及revealNFT proof的验证。

核心合约文件为NFT.sol,这是一个实现ERC721的Solidity智能合约，它包含了OpenZeppelin的ERC721Enumerable和Ownable合约,以及上述三个验证合约:partialRevealProof、mintProof和revealProof。

该合约创建了一个名为ZKNFT的合约。它实现了ERC721Enumerable和Ownable合约，因此具有与这些合约提供的相同的功能和行为。此外，该合约还定义了一个名为 character的结构，表示NFT的属性和其他状态数据。

该合约还定义了以下函数：

* mint - 创建一个新的NFT，用户需要提供一些私密的输入，以证明其满足某些条件。当这些输入被验证时，将为用户创建一个新的NFT，并将其所有权转移给用户自己。

* reveal - 揭露NFT的所有属性。只有NFT的所有者才能执行此操作。一旦执行，该NFT将被标记为已暴露，其所有属性将被记录在合约状态中。

* partialReveal1 - 部分揭露属性。允许所有者选择性地揭示其NFT的某些属性(例如,attribute1 > 3)。这些部分揭示的属性将被记录在合约状态中，但未揭示的属性将保持私密。

* createBid - 对NFT出价。

* acceptBid - 接受出价。如果NFT的所有者是初始所有者，则必须同时揭示NFT和出价。否则，只需将NFT所有权转移给买家即可。

* withdraw - 从合约中提取所有资金。

**备注：mint、reveal、partialReveal1等函数均需要通过相应的proof验证才能执行相应逻辑。**

最后，该合约还定义了几个用于跟踪状态和触发事件的映射和事件。